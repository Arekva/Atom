using Silk.NET.Maths;

namespace Atom.Engine.Astro;

public class BlackBody
{
    private const f64 MAP_MIN =  1000;
    private const f64 MAP_MAX = 40000;

    private const f64 DELTA   =   100;
    
    private static readonly Dictionary<u16, Vector4D<f64>> COLOR_MAP = new()
    {
        { 1000 , new(1.0000, 0.0337, 0.0000, 1.0D) },
        { 1100 , new(1.0000, 0.0592, 0.0000, 1.0D) },
        { 1200 , new(1.0000, 0.0846, 0.0000, 1.0D) },
        { 1300 , new(1.0000, 0.1096, 0.0000, 1.0D) },
        { 1400 , new(1.0000, 0.1341, 0.0000, 1.0D) },
        { 1500 , new(1.0000, 0.1578, 0.0000, 1.0D) },
        { 1600 , new(1.0000, 0.1806, 0.0000, 1.0D) },
        { 1700 , new(1.0000, 0.2025, 0.0000, 1.0D) },
        { 1800 , new(1.0000, 0.2235, 0.0000, 1.0D) },
        { 1900 , new(1.0000, 0.2434, 0.0000, 1.0D) },
        { 2000 , new(1.0000, 0.2647, 0.0033, 1.0D) },
        { 2100 , new(1.0000, 0.2889, 0.0120, 1.0D) },
        { 2200 , new(1.0000, 0.3126, 0.0219, 1.0D) },
        { 2300 , new(1.0000, 0.3360, 0.0331, 1.0D) },
        { 2400 , new(1.0000, 0.3589, 0.0454, 1.0D) },
        { 2500 , new(1.0000, 0.3814, 0.0588, 1.0D) },
        { 2600 , new(1.0000, 0.4034, 0.0734, 1.0D) },
        { 2700 , new(1.0000, 0.4250, 0.0889, 1.0D) },
        { 2800 , new(1.0000, 0.4461, 0.1054, 1.0D) },
        { 2900 , new(1.0000, 0.4668, 0.1229, 1.0D) },
        { 3000 , new(1.0000, 0.4870, 0.1411, 1.0D) },
        { 3100 , new(1.0000, 0.5067, 0.1602, 1.0D) },
        { 3200 , new(1.0000, 0.5259, 0.1800, 1.0D) },
        { 3300 , new(1.0000, 0.5447, 0.2005, 1.0D) },
        { 3400 , new(1.0000, 0.5630, 0.2216, 1.0D) },
        { 3500 , new(1.0000, 0.5809, 0.2433, 1.0D) },
        { 3600 , new(1.0000, 0.5983, 0.2655, 1.0D) },
        { 3700 , new(1.0000, 0.6153, 0.2881, 1.0D) },
        { 3800 , new(1.0000, 0.6318, 0.3112, 1.0D) },
        { 3900 , new(1.0000, 0.6480, 0.3346, 1.0D) },
        { 4000 , new(1.0000, 0.6636, 0.3583, 1.0D) },
        { 4100 , new(1.0000, 0.6789, 0.3823, 1.0D) },
        { 4200 , new(1.0000, 0.6938, 0.4066, 1.0D) },
        { 4300 , new(1.0000, 0.7083, 0.4310, 1.0D) },
        { 4400 , new(1.0000, 0.7223, 0.4556, 1.0D) },
        { 4500 , new(1.0000, 0.7360, 0.4803, 1.0D) },
        { 4600 , new(1.0000, 0.7494, 0.5051, 1.0D) },
        { 4700 , new(1.0000, 0.7623, 0.5299, 1.0D) },
        { 4800 , new(1.0000, 0.7750, 0.5548, 1.0D) },
        { 4900 , new(1.0000, 0.7872, 0.5797, 1.0D) },
        { 5000 , new(1.0000, 0.7992, 0.6045, 1.0D) },
        { 5100 , new(1.0000, 0.8108, 0.6293, 1.0D) },
        { 5200 , new(1.0000, 0.8221, 0.6541, 1.0D) },
        { 5300 , new(1.0000, 0.8330, 0.6787, 1.0D) },
        { 5400 , new(1.0000, 0.8437, 0.7032, 1.0D) },
        { 5500 , new(1.0000, 0.8541, 0.7277, 1.0D) },
        { 5600 , new(1.0000, 0.8642, 0.7519, 1.0D) },
        { 5700 , new(1.0000, 0.8740, 0.7760, 1.0D) },
        { 5800 , new(1.0000, 0.8836, 0.8000, 1.0D) },
        { 5900 , new(1.0000, 0.8929, 0.8238, 1.0D) },
        { 6000 , new(1.0000, 0.9019, 0.8473, 1.0D) },
        { 6100 , new(1.0000, 0.9107, 0.8707, 1.0D) },
        { 6200 , new(1.0000, 0.9193, 0.8939, 1.0D) },
        { 6300 , new(1.0000, 0.9276, 0.9168, 1.0D) },
        { 6400 , new(1.0000, 0.9357, 0.9396, 1.0D) },
        { 6500 , new(1.0000, 0.9436, 0.9621, 1.0D) },
        { 6600 , new(1.0000, 0.9513, 0.9844, 1.0D) },
        { 6700 , new(0.9937, 0.9526, 1.0000, 1.0D) },
        { 6800 , new(0.9726, 0.9395, 1.0000, 1.0D) },
        { 6900 , new(0.9526, 0.9270, 1.0000, 1.0D) },
        { 7000 , new(0.9337, 0.9150, 1.0000, 1.0D) },
        { 7100 , new(0.9157, 0.9035, 1.0000, 1.0D) },
        { 7200 , new(0.8986, 0.8925, 1.0000, 1.0D) },
        { 7300 , new(0.8823, 0.8819, 1.0000, 1.0D) },
        { 7400 , new(0.8668, 0.8718, 1.0000, 1.0D) },
        { 7500 , new(0.8520, 0.8621, 1.0000, 1.0D) },
        { 7600 , new(0.8379, 0.8527, 1.0000, 1.0D) },
        { 7700 , new(0.8244, 0.8437, 1.0000, 1.0D) },
        { 7800 , new(0.8115, 0.8351, 1.0000, 1.0D) },
        { 7900 , new(0.7992, 0.8268, 1.0000, 1.0D) },
        { 8000 , new(0.7874, 0.8187, 1.0000, 1.0D) },
        { 8100 , new(0.7761, 0.8110, 1.0000, 1.0D) },
        { 8200 , new(0.7652, 0.8035, 1.0000, 1.0D) },
        { 8300 , new(0.7548, 0.7963, 1.0000, 1.0D) },
        { 8400 , new(0.7449, 0.7894, 1.0000, 1.0D) },
        { 8500 , new(0.7353, 0.7827, 1.0000, 1.0D) },
        { 8600 , new(0.7260, 0.7762, 1.0000, 1.0D) },
        { 8700 , new(0.7172, 0.7699, 1.0000, 1.0D) },
        { 8800 , new(0.7086, 0.7638, 1.0000, 1.0D) },
        { 8900 , new(0.7004, 0.7579, 1.0000, 1.0D) },
        { 9000 , new(0.6925, 0.7522, 1.0000, 1.0D) },
        { 9100 , new(0.6848, 0.7467, 1.0000, 1.0D) },
        { 9200 , new(0.6774, 0.7414, 1.0000, 1.0D) },
        { 9300 , new(0.6703, 0.7362, 1.0000, 1.0D) },
        { 9400 , new(0.6635, 0.7311, 1.0000, 1.0D) },
        { 9500 , new(0.6568, 0.7263, 1.0000, 1.0D) },
        { 9600 , new(0.6504, 0.7215, 1.0000, 1.0D) },
        { 9700 , new(0.6442, 0.7169, 1.0000, 1.0D) },
        { 9800 , new(0.6382, 0.7124, 1.0000, 1.0D) },
        { 9900 , new(0.6324, 0.7081, 1.0000, 1.0D) },
        { 10000, new(0.6268, 0.7039, 1.0000, 1.0D) },
        { 10100, new(0.6213, 0.6998, 1.0000, 1.0D) },
        { 10200, new(0.6161, 0.6958, 1.0000, 1.0D) },
        { 10300, new(0.6109, 0.6919, 1.0000, 1.0D) },
        { 10400, new(0.6060, 0.6881, 1.0000, 1.0D) },
        { 10500, new(0.6012, 0.6844, 1.0000, 1.0D) },
        { 10600, new(0.5965, 0.6808, 1.0000, 1.0D) },
        { 10700, new(0.5919, 0.6773, 1.0000, 1.0D) },
        { 10800, new(0.5875, 0.6739, 1.0000, 1.0D) },
        { 10900, new(0.5833, 0.6706, 1.0000, 1.0D) },
        { 11000, new(0.5791, 0.6674, 1.0000, 1.0D) },
        { 11100, new(0.5750, 0.6642, 1.0000, 1.0D) },
        { 11200, new(0.5711, 0.6611, 1.0000, 1.0D) },
        { 11300, new(0.5673, 0.6581, 1.0000, 1.0D) },
        { 11400, new(0.5636, 0.6552, 1.0000, 1.0D) },
        { 11500, new(0.5599, 0.6523, 1.0000, 1.0D) },
        { 11600, new(0.5564, 0.6495, 1.0000, 1.0D) },
        { 11700, new(0.5530, 0.6468, 1.0000, 1.0D) },
        { 11800, new(0.5496, 0.6441, 1.0000, 1.0D) },
        { 11900, new(0.5463, 0.6415, 1.0000, 1.0D) },
        { 12000, new(0.5431, 0.6389, 1.0000, 1.0D) },
        { 12100, new(0.5400, 0.6364, 1.0000, 1.0D) },
        { 12200, new(0.5370, 0.6340, 1.0000, 1.0D) },
        { 12300, new(0.5340, 0.6316, 1.0000, 1.0D) },
        { 12400, new(0.5312, 0.6293, 1.0000, 1.0D) },
        { 12500, new(0.5283, 0.6270, 1.0000, 1.0D) },
        { 12600, new(0.5256, 0.6247, 1.0000, 1.0D) },
        { 12700, new(0.5229, 0.6225, 1.0000, 1.0D) },
        { 12800, new(0.5203, 0.6204, 1.0000, 1.0D) },
        { 12900, new(0.5177, 0.6183, 1.0000, 1.0D) },
        { 13000, new(0.5152, 0.6162, 1.0000, 1.0D) },
        { 13100, new(0.5128, 0.6142, 1.0000, 1.0D) },
        { 13200, new(0.5104, 0.6122, 1.0000, 1.0D) },
        { 13300, new(0.5080, 0.6103, 1.0000, 1.0D) },
        { 13400, new(0.5057, 0.6084, 1.0000, 1.0D) },
        { 13500, new(0.5035, 0.6065, 1.0000, 1.0D) },
        { 13600, new(0.5013, 0.6047, 1.0000, 1.0D) },
        { 13700, new(0.4991, 0.6029, 1.0000, 1.0D) },
        { 13800, new(0.4970, 0.6012, 1.0000, 1.0D) },
        { 13900, new(0.4950, 0.5994, 1.0000, 1.0D) },
        { 14000, new(0.4930, 0.5978, 1.0000, 1.0D) },
        { 14100, new(0.4910, 0.5961, 1.0000, 1.0D) },
        { 14200, new(0.4891, 0.5945, 1.0000, 1.0D) },
        { 14300, new(0.4872, 0.5929, 1.0000, 1.0D) },
        { 14400, new(0.4853, 0.5913, 1.0000, 1.0D) },
        { 14500, new(0.4835, 0.5898, 1.0000, 1.0D) },
        { 14600, new(0.4817, 0.5882, 1.0000, 1.0D) },
        { 14700, new(0.4799, 0.5868, 1.0000, 1.0D) },
        { 14800, new(0.4782, 0.5853, 1.0000, 1.0D) },
        { 14900, new(0.4765, 0.5839, 1.0000, 1.0D) },
        { 15000, new(0.4749, 0.5824, 1.0000, 1.0D) },
        { 15100, new(0.4733, 0.5811, 1.0000, 1.0D) },
        { 15200, new(0.4717, 0.5797, 1.0000, 1.0D) },
        { 15300, new(0.4701, 0.5784, 1.0000, 1.0D) },
        { 15400, new(0.4686, 0.5770, 1.0000, 1.0D) },
        { 15500, new(0.4671, 0.5757, 1.0000, 1.0D) },
        { 15600, new(0.4656, 0.5745, 1.0000, 1.0D) },
        { 15700, new(0.4641, 0.5732, 1.0000, 1.0D) },
        { 15800, new(0.4627, 0.5720, 1.0000, 1.0D) },
        { 15900, new(0.4613, 0.5708, 1.0000, 1.0D) },
        { 16000, new(0.4599, 0.5696, 1.0000, 1.0D) },
        { 16100, new(0.4586, 0.5684, 1.0000, 1.0D) },
        { 16200, new(0.4572, 0.5673, 1.0000, 1.0D) },
        { 16300, new(0.4559, 0.5661, 1.0000, 1.0D) },
        { 16400, new(0.4546, 0.5650, 1.0000, 1.0D) },
        { 16500, new(0.4534, 0.5639, 1.0000, 1.0D) },
        { 16600, new(0.4521, 0.5628, 1.0000, 1.0D) },
        { 16700, new(0.4509, 0.5617, 1.0000, 1.0D) },
        { 16800, new(0.4497, 0.5607, 1.0000, 1.0D) },
        { 16900, new(0.4485, 0.5597, 1.0000, 1.0D) },
        { 17000, new(0.4474, 0.5586, 1.0000, 1.0D) },
        { 17100, new(0.4462, 0.5576, 1.0000, 1.0D) },
        { 17200, new(0.4451, 0.5566, 1.0000, 1.0D) },
        { 17300, new(0.4440, 0.5557, 1.0000, 1.0D) },
        { 17400, new(0.4429, 0.5547, 1.0000, 1.0D) },
        { 17500, new(0.4418, 0.5538, 1.0000, 1.0D) },
        { 17600, new(0.4408, 0.5528, 1.0000, 1.0D) },
        { 17700, new(0.4397, 0.5519, 1.0000, 1.0D) },
        { 17800, new(0.4387, 0.5510, 1.0000, 1.0D) },
        { 17900, new(0.4377, 0.5501, 1.0000, 1.0D) },
        { 18000, new(0.4367, 0.5492, 1.0000, 1.0D) },
        { 18100, new(0.4357, 0.5483, 1.0000, 1.0D) },
        { 18200, new(0.4348, 0.5475, 1.0000, 1.0D) },
        { 18300, new(0.4338, 0.5466, 1.0000, 1.0D) },
        { 18400, new(0.4329, 0.5458, 1.0000, 1.0D) },
        { 18500, new(0.4319, 0.5450, 1.0000, 1.0D) },
        { 18600, new(0.4310, 0.5442, 1.0000, 1.0D) },
        { 18700, new(0.4301, 0.5434, 1.0000, 1.0D) },
        { 18800, new(0.4293, 0.5426, 1.0000, 1.0D) },
        { 18900, new(0.4284, 0.5418, 1.0000, 1.0D) },
        { 19000, new(0.4275, 0.5410, 1.0000, 1.0D) },
        { 19100, new(0.4267, 0.5403, 1.0000, 1.0D) },
        { 19200, new(0.4258, 0.5395, 1.0000, 1.0D) },
        { 19300, new(0.4250, 0.5388, 1.0000, 1.0D) },
        { 19400, new(0.4242, 0.5381, 1.0000, 1.0D) },
        { 19500, new(0.4234, 0.5373, 1.0000, 1.0D) },
        { 19600, new(0.4226, 0.5366, 1.0000, 1.0D) },
        { 19700, new(0.4218, 0.5359, 1.0000, 1.0D) },
        { 19800, new(0.4211, 0.5352, 1.0000, 1.0D) },
        { 19900, new(0.4203, 0.5345, 1.0000, 1.0D) },
        { 20000, new(0.4196, 0.5339, 1.0000, 1.0D) },
        { 20100, new(0.4188, 0.5332, 1.0000, 1.0D) },
        { 20200, new(0.4181, 0.5325, 1.0000, 1.0D) },
        { 20300, new(0.4174, 0.5319, 1.0000, 1.0D) },
        { 20400, new(0.4167, 0.5312, 1.0000, 1.0D) },
        { 20500, new(0.4160, 0.5306, 1.0000, 1.0D) },
        { 20600, new(0.4153, 0.5300, 1.0000, 1.0D) },
        { 20700, new(0.4146, 0.5293, 1.0000, 1.0D) },
        { 20800, new(0.4139, 0.5287, 1.0000, 1.0D) },
        { 20900, new(0.4133, 0.5281, 1.0000, 1.0D) },
        { 21000, new(0.4126, 0.5275, 1.0000, 1.0D) },
        { 21100, new(0.4119, 0.5269, 1.0000, 1.0D) },
        { 21200, new(0.4113, 0.5264, 1.0000, 1.0D) },
        { 21300, new(0.4107, 0.5258, 1.0000, 1.0D) },
        { 21400, new(0.4100, 0.5252, 1.0000, 1.0D) },
        { 21500, new(0.4094, 0.5246, 1.0000, 1.0D) },
        { 21600, new(0.4088, 0.5241, 1.0000, 1.0D) },
        { 21700, new(0.4082, 0.5235, 1.0000, 1.0D) },
        { 21800, new(0.4076, 0.5230, 1.0000, 1.0D) },
        { 21900, new(0.4070, 0.5224, 1.0000, 1.0D) },
        { 22000, new(0.4064, 0.5219, 1.0000, 1.0D) },
        { 22100, new(0.4059, 0.5214, 1.0000, 1.0D) },
        { 22200, new(0.4053, 0.5209, 1.0000, 1.0D) },
        { 22300, new(0.4047, 0.5203, 1.0000, 1.0D) },
        { 22400, new(0.4042, 0.5198, 1.0000, 1.0D) },
        { 22500, new(0.4036, 0.5193, 1.0000, 1.0D) },
        { 22600, new(0.4031, 0.5188, 1.0000, 1.0D) },
        { 22700, new(0.4026, 0.5183, 1.0000, 1.0D) },
        { 22800, new(0.4020, 0.5178, 1.0000, 1.0D) },
        { 22900, new(0.4015, 0.5174, 1.0000, 1.0D) },
        { 23000, new(0.4010, 0.5169, 1.0000, 1.0D) },
        { 23100, new(0.4005, 0.5164, 1.0000, 1.0D) },
        { 23200, new(0.4000, 0.5159, 1.0000, 1.0D) },
        { 23300, new(0.3995, 0.5155, 1.0000, 1.0D) },
        { 23400, new(0.3990, 0.5150, 1.0000, 1.0D) },
        { 23500, new(0.3985, 0.5146, 1.0000, 1.0D) },
        { 23600, new(0.3980, 0.5141, 1.0000, 1.0D) },
        { 23700, new(0.3975, 0.5137, 1.0000, 1.0D) },
        { 23800, new(0.3970, 0.5132, 1.0000, 1.0D) },
        { 23900, new(0.3966, 0.5128, 1.0000, 1.0D) },
        { 24000, new(0.3961, 0.5123, 1.0000, 1.0D) },
        { 24100, new(0.3956, 0.5119, 1.0000, 1.0D) },
        { 24200, new(0.3952, 0.5115, 1.0000, 1.0D) },
        { 24300, new(0.3947, 0.5111, 1.0000, 1.0D) },
        { 24400, new(0.3943, 0.5107, 1.0000, 1.0D) },
        { 24500, new(0.3938, 0.5103, 1.0000, 1.0D) },
        { 24600, new(0.3934, 0.5098, 1.0000, 1.0D) },
        { 24700, new(0.3930, 0.5094, 1.0000, 1.0D) },
        { 24800, new(0.3925, 0.5090, 1.0000, 1.0D) },
        { 24900, new(0.3921, 0.5086, 1.0000, 1.0D) },
        { 25000, new(0.3917, 0.5083, 1.0000, 1.0D) },
        { 25100, new(0.3913, 0.5079, 1.0000, 1.0D) },
        { 25200, new(0.3909, 0.5075, 1.0000, 1.0D) },
        { 25300, new(0.3905, 0.5071, 1.0000, 1.0D) },
        { 25400, new(0.3901, 0.5067, 1.0000, 1.0D) },
        { 25500, new(0.3897, 0.5064, 1.0000, 1.0D) },
        { 25600, new(0.3893, 0.5060, 1.0000, 1.0D) },
        { 25700, new(0.3889, 0.5056, 1.0000, 1.0D) },
        { 25800, new(0.3885, 0.5053, 1.0000, 1.0D) },
        { 25900, new(0.3881, 0.5049, 1.0000, 1.0D) },
        { 26000, new(0.3877, 0.5045, 1.0000, 1.0D) },
        { 26100, new(0.3874, 0.5042, 1.0000, 1.0D) },
        { 26200, new(0.3870, 0.5038, 1.0000, 1.0D) },
        { 26300, new(0.3866, 0.5035, 1.0000, 1.0D) },
        { 26400, new(0.3863, 0.5032, 1.0000, 1.0D) },
        { 26500, new(0.3859, 0.5028, 1.0000, 1.0D) },
        { 26600, new(0.3855, 0.5025, 1.0000, 1.0D) },
        { 26700, new(0.3852, 0.5021, 1.0000, 1.0D) },
        { 26800, new(0.3848, 0.5018, 1.0000, 1.0D) },
        { 26900, new(0.3845, 0.5015, 1.0000, 1.0D) },
        { 27000, new(0.3841, 0.5012, 1.0000, 1.0D) },
        { 27100, new(0.3838, 0.5008, 1.0000, 1.0D) },
        { 27200, new(0.3835, 0.5005, 1.0000, 1.0D) },
        { 27300, new(0.3831, 0.5002, 1.0000, 1.0D) },
        { 27400, new(0.3828, 0.4999, 1.0000, 1.0D) },
        { 27500, new(0.3825, 0.4996, 1.0000, 1.0D) },
        { 27600, new(0.3821, 0.4993, 1.0000, 1.0D) },
        { 27700, new(0.3818, 0.4990, 1.0000, 1.0D) },
        { 27800, new(0.3815, 0.4987, 1.0000, 1.0D) },
        { 27900, new(0.3812, 0.4984, 1.0000, 1.0D) },
        { 28000, new(0.3809, 0.4981, 1.0000, 1.0D) },
        { 28100, new(0.3805, 0.4978, 1.0000, 1.0D) },
        { 28200, new(0.3802, 0.4975, 1.0000, 1.0D) },
        { 28300, new(0.3799, 0.4972, 1.0000, 1.0D) },
        { 28400, new(0.3796, 0.4969, 1.0000, 1.0D) },
        { 28500, new(0.3793, 0.4966, 1.0000, 1.0D) },
        { 28600, new(0.3790, 0.4963, 1.0000, 1.0D) },
        { 28700, new(0.3787, 0.4960, 1.0000, 1.0D) },
        { 28800, new(0.3784, 0.4958, 1.0000, 1.0D) },
        { 28900, new(0.3781, 0.4955, 1.0000, 1.0D) },
        { 29000, new(0.3779, 0.4952, 1.0000, 1.0D) },
        { 29100, new(0.3776, 0.4949, 1.0000, 1.0D) },
        { 29200, new(0.3773, 0.4947, 1.0000, 1.0D) },
        { 29300, new(0.3770, 0.4944, 1.0000, 1.0D) },
        { 29400, new(0.3767, 0.4941, 1.0000, 1.0D) },
        { 29500, new(0.3764, 0.4939, 1.0000, 1.0D) },
        { 29600, new(0.3762, 0.4936, 1.0000, 1.0D) },
        { 29700, new(0.3759, 0.4934, 1.0000, 1.0D) },
        { 29800, new(0.3756, 0.4931, 1.0000, 1.0D) },
        { 29900, new(0.3754, 0.4928, 1.0000, 1.0D) },
        { 30000, new(0.3751, 0.4926, 1.0000, 1.0D) },
        { 30100, new(0.3748, 0.4923, 1.0000, 1.0D) },
        { 30200, new(0.3746, 0.4921, 1.0000, 1.0D) },
        { 30300, new(0.3743, 0.4918, 1.0000, 1.0D) },
        { 30400, new(0.3741, 0.4916, 1.0000, 1.0D) },
        { 30500, new(0.3738, 0.4914, 1.0000, 1.0D) },
        { 30600, new(0.3735, 0.4911, 1.0000, 1.0D) },
        { 30700, new(0.3733, 0.4909, 1.0000, 1.0D) },
        { 30800, new(0.3730, 0.4906, 1.0000, 1.0D) },
        { 30900, new(0.3728, 0.4904, 1.0000, 1.0D) },
        { 31000, new(0.3726, 0.4902, 1.0000, 1.0D) },
        { 31100, new(0.3723, 0.4899, 1.0000, 1.0D) },
        { 31200, new(0.3721, 0.4897, 1.0000, 1.0D) },
        { 31300, new(0.3718, 0.4895, 1.0000, 1.0D) },
        { 31400, new(0.3716, 0.4893, 1.0000, 1.0D) },
        { 31500, new(0.3714, 0.4890, 1.0000, 1.0D) },
        { 31600, new(0.3711, 0.4888, 1.0000, 1.0D) },
        { 31700, new(0.3709, 0.4886, 1.0000, 1.0D) },
        { 31800, new(0.3707, 0.4884, 1.0000, 1.0D) },
        { 31900, new(0.3704, 0.4881, 1.0000, 1.0D) },
        { 32000, new(0.3702, 0.4879, 1.0000, 1.0D) },
        { 32100, new(0.3700, 0.4877, 1.0000, 1.0D) },
        { 32200, new(0.3698, 0.4875, 1.0000, 1.0D) },
        { 32300, new(0.3695, 0.4873, 1.0000, 1.0D) },
        { 32400, new(0.3693, 0.4871, 1.0000, 1.0D) },
        { 32500, new(0.3691, 0.4869, 1.0000, 1.0D) },
        { 32600, new(0.3689, 0.4867, 1.0000, 1.0D) },
        { 32700, new(0.3687, 0.4864, 1.0000, 1.0D) },
        { 32800, new(0.3684, 0.4862, 1.0000, 1.0D) },
        { 32900, new(0.3682, 0.4860, 1.0000, 1.0D) },
        { 33000, new(0.3680, 0.4858, 1.0000, 1.0D) },
        { 33100, new(0.3678, 0.4856, 1.0000, 1.0D) },
        { 33200, new(0.3676, 0.4854, 1.0000, 1.0D) },
        { 33300, new(0.3674, 0.4852, 1.0000, 1.0D) },
        { 33400, new(0.3672, 0.4850, 1.0000, 1.0D) },
        { 33500, new(0.3670, 0.4848, 1.0000, 1.0D) },
        { 33600, new(0.3668, 0.4847, 1.0000, 1.0D) },
        { 33700, new(0.3666, 0.4845, 1.0000, 1.0D) },
        { 33800, new(0.3664, 0.4843, 1.0000, 1.0D) },
        { 33900, new(0.3662, 0.4841, 1.0000, 1.0D) },
        { 34000, new(0.3660, 0.4839, 1.0000, 1.0D) },
        { 34100, new(0.3658, 0.4837, 1.0000, 1.0D) },
        { 34200, new(0.3656, 0.4835, 1.0000, 1.0D) },
        { 34300, new(0.3654, 0.4833, 1.0000, 1.0D) },
        { 34400, new(0.3652, 0.4831, 1.0000, 1.0D) },
        { 34500, new(0.3650, 0.4830, 1.0000, 1.0D) },
        { 34600, new(0.3649, 0.4828, 1.0000, 1.0D) },
        { 34700, new(0.3647, 0.4826, 1.0000, 1.0D) },
        { 34800, new(0.3645, 0.4824, 1.0000, 1.0D) },
        { 34900, new(0.3643, 0.4822, 1.0000, 1.0D) },
        { 35000, new(0.3641, 0.4821, 1.0000, 1.0D) },
        { 35100, new(0.3639, 0.4819, 1.0000, 1.0D) },
        { 35200, new(0.3638, 0.4817, 1.0000, 1.0D) },
        { 35300, new(0.3636, 0.4815, 1.0000, 1.0D) },
        { 35400, new(0.3634, 0.4814, 1.0000, 1.0D) },
        { 35500, new(0.3632, 0.4812, 1.0000, 1.0D) },
        { 35600, new(0.3630, 0.4810, 1.0000, 1.0D) },
        { 35700, new(0.3629, 0.4809, 1.0000, 1.0D) },
        { 35800, new(0.3627, 0.4807, 1.0000, 1.0D) },
        { 35900, new(0.3625, 0.4805, 1.0000, 1.0D) },
        { 36000, new(0.3624, 0.4804, 1.0000, 1.0D) },
        { 36100, new(0.3622, 0.4802, 1.0000, 1.0D) },
        { 36200, new(0.3620, 0.4800, 1.0000, 1.0D) },
        { 36300, new(0.3619, 0.4799, 1.0000, 1.0D) },
        { 36400, new(0.3617, 0.4797, 1.0000, 1.0D) },
        { 36500, new(0.3615, 0.4796, 1.0000, 1.0D) },
        { 36600, new(0.3614, 0.4794, 1.0000, 1.0D) },
        { 36700, new(0.3612, 0.4792, 1.0000, 1.0D) },
        { 36800, new(0.3610, 0.4791, 1.0000, 1.0D) },
        { 36900, new(0.3609, 0.4789, 1.0000, 1.0D) },
        { 37000, new(0.3607, 0.4788, 1.0000, 1.0D) },
        { 37100, new(0.3605, 0.4786, 1.0000, 1.0D) },
        { 37200, new(0.3604, 0.4785, 1.0000, 1.0D) },
        { 37300, new(0.3602, 0.4783, 1.0000, 1.0D) },
        { 37400, new(0.3601, 0.4782, 1.0000, 1.0D) },
        { 37500, new(0.3599, 0.4780, 1.0000, 1.0D) },
        { 37600, new(0.3598, 0.4779, 1.0000, 1.0D) },
        { 37700, new(0.3596, 0.4777, 1.0000, 1.0D) },
        { 37800, new(0.3595, 0.4776, 1.0000, 1.0D) },
        { 37900, new(0.3593, 0.4774, 1.0000, 1.0D) },
        { 38000, new(0.3592, 0.4773, 1.0000, 1.0D) },
        { 38100, new(0.3590, 0.4771, 1.0000, 1.0D) },
        { 38200, new(0.3589, 0.4770, 1.0000, 1.0D) },
        { 38300, new(0.3587, 0.4768, 1.0000, 1.0D) },
        { 38400, new(0.3586, 0.4767, 1.0000, 1.0D) },
        { 38500, new(0.3584, 0.4766, 1.0000, 1.0D) },
        { 38600, new(0.3583, 0.4764, 1.0000, 1.0D) },
        { 38700, new(0.3581, 0.4763, 1.0000, 1.0D) },
        { 38800, new(0.3580, 0.4761, 1.0000, 1.0D) },
        { 38900, new(0.3579, 0.4760, 1.0000, 1.0D) },
        { 39000, new(0.3577, 0.4759, 1.0000, 1.0D) },
        { 39100, new(0.3576, 0.4757, 1.0000, 1.0D) },
        { 39200, new(0.3574, 0.4756, 1.0000, 1.0D) },
        { 39300, new(0.3573, 0.4755, 1.0000, 1.0D) },
        { 39400, new(0.3572, 0.4753, 1.0000, 1.0D) },
        { 39500, new(0.3570, 0.4752, 1.0000, 1.0D) },
        { 39600, new(0.3569, 0.4751, 1.0000, 1.0D) },
        { 39700, new(0.3567, 0.4749, 1.0000, 1.0D) },
        { 39800, new(0.3566, 0.4748, 1.0000, 1.0D) },
        { 39900, new(0.3565, 0.4747, 1.0000, 1.0D) },
        { 40000, new(0.3563, 0.4745, 1.0000, 1.0D) },
    };
    
    // ReSharper disable once InconsistentNaming
    public static Vector4D<f64> GetRGBColor(f64 temperature)
    {
        if (temperature < 0.0D) throw new ArgumentException(
            message: "Oh god I think you're getting back in time; the temperature is negative !", nameof(temperature));

        f64 temp = Math.Clamp(temperature, MAP_MIN, MAP_MAX);

        f64 low  = AMath.AlignLower(temp, DELTA);
        f64 high = AMath.AlignUpper(temp, DELTA);

        f64 time = AMath.Map(temp, low, high, 0.0, 1.0);
        
        u16 i_low  = (u16)low ;
        u16 i_high = (u16)high;

        return Vector4D.Lerp(COLOR_MAP[i_low], COLOR_MAP[i_high], time);
    }
}